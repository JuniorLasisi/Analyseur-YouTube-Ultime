<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyseur YouTube Ultime - Statistiques et Tendances</title>
    <meta name="description" content="Analysez en profondeur les vid√©os et cha√Ænes YouTube. Obtenez des statistiques d√©taill√©es, des tendances et des insights pour optimiser votre contenu.">
    <meta name="keywords" content="YouTube, analyse, statistiques, vid√©o, cha√Æne, tendances, engagement, SEO">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-top: 20px;
        }
        h1, h2 {
            color: #ff0000;
            text-align: center;
            margin-bottom: 30px;
        }
        .logo {
            display: block;
            margin: 0 auto 20px;
            max-width: 200px;
        }
        form {
            display: flex;
            margin-bottom: 20px;
        }
        input[type="text"] {
            flex-grow: 1;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #ff0000;
            color: #fff;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #cc0000;
        }
        #results, #channel-results {
            display: none;
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        canvas {
            max-width: 100%;
            margin-top: 20px;
        }
        .error {
            color: #ff0000;
            margin-top: 10px;
            text-align: center;
        }
        #loading {
            text-align: center;
            margin-top: 20px;
        }
        .thumbnail-container, .channel-image-container {
            margin-top: 20px;
            text-align: center;
        }
        .thumbnail-container img, .channel-image-container img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .download-links {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .download-links a {
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
        }
        .hashtags, .keywords {
            margin-top: 20px;
            font-style: italic;
        }
        .channel-link {
            margin-top: 10px;
        }
        .channel-link a {
            color: #ff0000;
            text-decoration: none;
        }
        .channel-link a:hover {
            text-decoration: underline;
        }
        .stat {
            font-weight: bold;
            color: #4CAF50;
        }
        .comments-section {
            margin-top: 20px;
        }
        .comment {
            background-color: #fff;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .positive {
            border-left: 4px solid #4CAF50;
        }
        .negative {
            border-left: 4px solid #f44336;
        }
        #warning {
            background-color: #ffffd0;
            border: 1px solid #e6db55;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/YouTube_Logo_2017.svg/1200px-YouTube_Logo_2017.svg.png" alt="YouTube Logo" class="logo">
        <h1>Analyseur YouTube Ultime</h1>
        <div id="warning">
            ‚ö†Ô∏è Attention : Les statistiques affich√©es sont des estimations et peuvent ne pas refl√©ter exactement les donn√©es r√©elles de YouTube.
        </div>
        <form id="youtube-form">
            <input type="text" id="youtube-url" placeholder="Entrez l'URL d'une vid√©o ou d'une cha√Æne YouTube" required>
            <button type="submit">Analyser</button>
        </form>
        <div id="error" class="error" style="display: none;"></div>
        <div id="loading" style="display: none;">‚è≥ Chargement en cours...</div>
        <div id="results">
            <h2>R√©sultats de l'analyse de la vid√©o</h2>
            <p>üé• Titre: <span id="video-title"></span></p>
            <p>üëÄ Vues: <span id="video-views" class="stat"></span></p>
            <p>üëç Likes: <span id="video-likes" class="stat"></span></p>
            <p>üí¨ Commentaires: <span id="video-comments" class="stat"></span></p>
            <p>üîÑ Partages estim√©s: <span id="video-shares" class="stat"></span></p>
            <p>üìä Taux d'engagement: <span id="engagement-rate" class="stat"></span></p>
            <p>üéØ Taux de r√©tention estim√©: <span id="retention-rate" class="stat"></span></p>
            <p>üñ±Ô∏è Taux de clic estim√©: <span id="click-through-rate" class="stat"></span></p>
            <p>‚è±Ô∏è Dur√©e de visionnage moyenne estim√©e: <span id="average-view-duration" class="stat"></span></p>
            <p>üí∞ Estimation des revenus: <span id="estimated-revenue" class="stat"></span></p>
            <p>üöÄ Estimation du nombre d'abonn√©s gagn√©s: <span id="estimated-new-subscribers" class="stat"></span></p>
            <p>üìà Estimation du nombre de vues par jour: <span id="estimated-views-per-day" class="stat"></span></p>
            <div class="hashtags">#Ô∏è‚É£ Hashtags: <span id="video-hashtags"></span></div>
            <div class="keywords">üîë Mots-cl√©s: <span id="video-keywords"></span></div>
            <div class="channel-link">üì∫ Cha√Æne: <a id="channel-link" href="#" target="_blank"></a></div>
            <canvas id="stats-chart"></canvas>
            <div class="thumbnail-container">
                <img id="video-thumbnail" src="" alt="Miniature de la vid√©o">
                <div class="download-links">
                    <a id="download-default" href="#" download>D√©faut</a>
                    <a id="download-medium" href="#" download>Moyenne</a>
                    <a id="download-high" href="#" download>Haute</a>
                    <a id="download-standard" href="#" download>Standard</a>
                    <a id="download-maxres" href="#" download>Max</a>
                </div>
            </div>
            <div class="comments-section">
                <h3>Commentaires</h3>
                <div id="comments-container"></div>
            </div>
        </div>
        <div id="channel-results">
            <h2>R√©sultats de l'analyse de la cha√Æne</h2>
            <p>üì∫ Nom de la cha√Æne: <span id="channel-title"></span></p>
            <p>üßë‚Äçü§ù‚Äçüßë Nombre d'abonn√©s: <span id="subscriber-count" class="stat"></span></p>
            <p>üëÄ Nombre total de vues: <span id="total-views" class="stat"></span></p>
            <p>üé¨ Nombre de vid√©os: <span id="video-count" class="stat"></span></p>
            <p>üìä Taux d'engagement moyen: <span id="channel-engagement-rate" class="stat"></span></p>
            <p>üí∞ Estimation des revenus de la cha√Æne: <span id="channel-estimated-revenue" class="stat"></span></p>
            <canvas id="channel-stats-chart"></canvas>
            <div class="channel-image-container">
                <h3>Photo de profil de la cha√Æne</h3>
                <img id="channel-profile-image" src="" alt="Photo de profil de la cha√Æne">
                <div class="download-links">
                    <a id="download-profile-image" href="#" download>T√©l√©charger</a>
                </div>
            </div>
            <div class="channel-image-container">
                <h3>Banni√®re de la cha√Æne</h3>
                <img id="channel-banner-image" src="" alt="Banni√®re de la cha√Æne">
                <div class="download-links">
                    <a id="download-banner-image" href="#" download>T√©l√©charger</a>
                </div>
            </div>
        </div>
    </div>

    <script>
    const API_KEY = 'AIzaSyAkF9xcoN9vd1xRKyWGDXIWyyfFOq_WbHE';
    let statsChart = null;
    let channelStatsChart = null;

    function extractId(url) {
        let id = null;
        let type = null;

        // Pour les vid√©os (y compris les liens courts)
        const videoRegExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
        const shortVideoRegExp = /^https?:\/\/youtu\.be\/([^\/\?]+)/;
        const videoMatch = url.match(videoRegExp) || url.match(shortVideoRegExp);
        if (videoMatch && (videoMatch[2]?.length == 11 || videoMatch[1]?.length == 11)) {
            id = videoMatch[2] || videoMatch[1];
            type = 'video';
            return { id, type };
        }

        // Pour les cha√Ænes
        const channelRegExp = /^.*(youtube.com\/(c\/|channel\/|user\/|@))([^\?\&\/]+).*/;
        const channelMatch = url.match(channelRegExp);
        if (channelMatch && channelMatch[3]) {
            id = channelMatch[3];
            type = 'channel';
            return { id, type };
        }

        return { id: null, type: null };
    }

    async function fetchData(id, type) {
        let endpoint;
        if (type === 'video') {
            endpoint = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${id}&key=${API_KEY}`;
        } else if (type === 'channel') {
            endpoint = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,brandingSettings&id=${id}&key=${API_KEY}`;
        } else {
            throw new Error('Type non reconnu');
        }

        const response = await fetch(endpoint);
        if (!response.ok) throw new Error('Erreur lors de la r√©cup√©ration des donn√©es');
        const data = await response.json();
        if (data.items.length === 0) throw new Error('Aucune donn√©e trouv√©e');
        return data.items[0];
    }

    async function fetchComments(videoId) {
        const endpoint = `https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&videoId=${videoId}&key=${API_KEY}&order=relevance&maxResults=20`;
        const response = await fetch(endpoint);
        if (!response.ok) throw new Error('Erreur lors de la r√©cup√©ration des commentaires');
        const data = await response.json();
        return data.items;
    }

    function displayVideoResults(data) {
        const views = parseInt(data.statistics.viewCount);
        const likes = parseInt(data.statistics.likeCount);
        const comments = parseInt(data.statistics.commentCount);
        const publishedAt = new Date(data.snippet.publishedAt);
        const daysSincePublished = Math.ceil((new Date() - publishedAt) / (1000 * 60 * 60 * 24));

        document.getElementById('video-title').textContent = data.snippet.title;
        document.getElementById('video-views').textContent = views.toLocaleString();
        document.getElementById('video-likes').textContent = likes.toLocaleString();
        document.getElementById('video-comments').textContent = comments.toLocaleString();

        // Estimation des partages (bas√© sur une hypoth√®se)
        const estimatedShares = Math.round(views * 0.01);
        document.getElementById('video-shares').textContent = estimatedShares.toLocaleString();

        // Calcul du taux d'engagement
        const engagementRate = ((likes + comments + estimatedShares) / views * 100).toFixed(2);
        document.getElementById('engagement-rate').textContent = `${engagementRate}%`;

        // Estimation du taux de r√©tention (bas√© sur une hypoth√®se)
        const estimatedRetentionRate = (Math.random() * (0.7 - 0.3) + 0.3).toFixed(2);
        document.getElementById('retention-rate').textContent = `${estimatedRetentionRate * 100}%`;

                // Estimation du taux de clic (bas√© sur une hypoth√®se)
        const estimatedCTR = (Math.random() * (0.2 - 0.05) + 0.05).toFixed(2);
        document.getElementById('click-through-rate').textContent = `${estimatedCTR * 100}%`;

        // Estimation de la dur√©e de visionnage moyenne (bas√©e sur une hypoth√®se)
        const averageViewDuration = Math.round(views * 0.6); // 60% de la dur√©e totale de la vid√©o
        const minutes = Math.floor(averageViewDuration / 60);
        const seconds = averageViewDuration % 60;
        document.getElementById('average-view-duration').textContent = `${minutes}m ${seconds}s`;

        // Estimation des revenus (bas√© sur une hypoth√®se)
        const estimatedRevenue = (views * 0.001).toFixed(2); // $1 pour 1000 vues
        document.getElementById('estimated-revenue').textContent = `$${estimatedRevenue}`;

        // Estimation du nombre d'abonn√©s gagn√©s (bas√© sur une hypoth√®se)
        const estimatedNewSubscribers = Math.round(views * 0.01);
        document.getElementById('estimated-new-subscribers').textContent = estimatedNewSubscribers.toLocaleString();

        // Estimation du nombre de vues par jour
        const estimatedViewsPerDay = Math.round(views / daysSincePublished);
        document.getElementById('estimated-views-per-day').textContent = estimatedViewsPerDay.toLocaleString();

        // Affichage des hashtags
        const hashtags = data.snippet.tags ? data.snippet.tags.map(tag => `#${tag}`).join(' ') : 'Aucun hashtag trouv√©';
        document.getElementById('video-hashtags').textContent = hashtags;

        // Extraction et affichage des mots-cl√©s
        const keywords = extractKeywords(data.snippet.title + ' ' + data.snippet.description);
        document.getElementById('video-keywords').textContent = keywords.join(', ');

        // Affichage du lien de la cha√Æne
        const channelLink = document.getElementById('channel-link');
        channelLink.href = `https://www.youtube.com/channel/${data.snippet.channelId}`;
        channelLink.textContent = data.snippet.channelTitle;

        // Cr√©ation ou mise √† jour du graphique
        const ctx = document.getElementById('stats-chart').getContext('2d');
        if (statsChart) {
            statsChart.destroy();
        }
        statsChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Vues', 'Likes', 'Commentaires', 'Partages estim√©s'],
                datasets: [{
                    label: 'Statistiques de la vid√©o',
                    data: [views, likes, comments, estimatedShares],
                    backgroundColor: ['rgba(255, 99, 132, 0.5)', 'rgba(54, 162, 235, 0.5)', 'rgba(255, 206, 86, 0.5)', 'rgba(75, 192, 192, 0.5)']
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Affichage et t√©l√©chargement des miniatures
        const thumbnails = data.snippet.thumbnails;
        document.getElementById('video-thumbnail').src = thumbnails.high.url;

        const downloadLinks = {
            'download-default': thumbnails.default.url,
            'download-medium': thumbnails.medium.url,
            'download-high': thumbnails.high.url,
            'download-standard': thumbnails.standard ? thumbnails.standard.url : null,
            'download-maxres': thumbnails.maxres ? thumbnails.maxres.url : null
        };

        for (const [id, url] of Object.entries(downloadLinks)) {
            const link = document.getElementById(id);
            if (url) {
                link.href = url;
                link.style.display = 'inline-block';
            } else {
                link.style.display = 'none';
            }
        }

        // Affichage des commentaires
        fetchComments(data.id).then(comments => {
            const commentsContainer = document.getElementById('comments-container');
            commentsContainer.innerHTML = '';
            comments.forEach(comment => {
                const commentText = comment.snippet.topLevelComment.snippet.textDisplay;
                const sentiment = analyzeSentiment(commentText);
                const commentElement = document.createElement('div');
                commentElement.className = `comment ${sentiment > 0 ? 'positive' : 'negative'}`;
                commentElement.textContent = commentText;
                commentsContainer.appendChild(commentElement);
            });
        });

        document.getElementById('results').style.display = 'block';
        document.getElementById('channel-results').style.display = 'none';
        document.getElementById('warning').style.display = 'block';
    }

    function displayChannelResults(data) {
        document.getElementById('channel-title').textContent = data.snippet.title;
        document.getElementById('subscriber-count').textContent = parseInt(data.statistics.subscriberCount).toLocaleString();
        document.getElementById('total-views').textContent = parseInt(data.statistics.viewCount).toLocaleString();
        document.getElementById('video-count').textContent = parseInt(data.statistics.videoCount).toLocaleString();

        // Calcul du taux d'engagement moyen de la cha√Æne
        const averageEngagementRate = (parseInt(data.statistics.subscriberCount) / parseInt(data.statistics.viewCount) * 100).toFixed(2);
        document.getElementById('channel-engagement-rate').textContent = `${averageEngagementRate}%`;

        // Estimation des revenus de la cha√Æne (bas√© sur une hypoth√®se)
        const estimatedChannelRevenue = (parseInt(data.statistics.viewCount) * 0.001).toFixed(2); // $1 pour 1000 vues
        document.getElementById('channel-estimated-revenue').textContent = `$${estimatedChannelRevenue}`;

        // Cr√©ation ou mise √† jour du graphique de la cha√Æne
        const ctx = document.getElementById('channel-stats-chart').getContext('2d');
        if (channelStatsChart) {
            channelStatsChart.destroy();
        }
        channelStatsChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Abonn√©s', 'Vues totales', 'Vid√©os'],
                datasets: [{
                    label: 'Statistiques de la cha√Æne',
                    data: [data.statistics.subscriberCount, data.statistics.viewCount, data.statistics.videoCount],
                    backgroundColor: ['rgba(255, 99, 132, 0.5)', 'rgba(54, 162, 235, 0.5)', 'rgba(255, 206, 86, 0.5)']
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Affichage et t√©l√©chargement de la photo de profil
        const profileImage = data.snippet.thumbnails.high.url;
        document.getElementById('channel-profile-image').src = profileImage;
        document.getElementById('download-profile-image').href = profileImage;

        // Affichage et t√©l√©chargement de la banni√®re
        if (data.brandingSettings && data.brandingSettings.image && data.brandingSettings.image.bannerExternalUrl) {
            const bannerImage = data.brandingSettings.image.bannerExternalUrl;
            document.getElementById('channel-banner-image').src = bannerImage;
            document.getElementById('download-banner-image').href = bannerImage;
            document.getElementById('channel-banner-image').style.display = 'block';
            document.getElementById('download-banner-image').style.display = 'inline-block';
        } else {
            document.getElementById('channel-banner-image').style.display = 'none';
            document.getElementById('download-banner-image').style.display = 'none';
        }

        document.getElementById('channel-results').style.display = 'block';
        document.getElementById('results').style.display = 'none';
        document.getElementById('warning').style.display = 'block';
    }

    function extractKeywords(text) {
        // Liste de mots vides en fran√ßais
        const stopWords = new Set(['le', 'la', 'les', 'un', 'une', 'des', 'et', 'ou', 'mais', 'donc', 'car', 'pour', 'dans', 'sur', 'avec', 'sans']);
        
        // Nettoyage et tokenisation du texte
        const words = text.toLowerCase().replace(/[^\w\s]/g, '').split(/\s+/);
        
        // Filtrage des mots vides et comptage des occurrences
        const wordCounts = {};
        words.forEach(word => {
            if (!stopWords.has(word) && word.length > 2) {
                wordCounts[word] = (wordCounts[word] || 0) + 1;
            }
        });
        
        // Tri des mots par nombre d'occurrences
        const sortedWords = Object.entries(wordCounts).sort((a, b) => b[1] - a[1]);
        
        // Retourne les 5 premiers mots-cl√©s
        return sortedWords.slice(0, 5).map(entry => entry[0]);
    }

    function analyzeSentiment(text) {
        // Liste de mots positifs et n√©gatifs (√† √©tendre pour une meilleure pr√©cision)
        const positiveWords = ['bon', 'super', 'g√©nial', 'excellent', 'incroyable', 'aime', 'bravo'];
        const negativeWords = ['mauvais', 'nul', 'terrible', 'horrible', 'd√©teste', 'd√©cevant'];

        let score = 0;
        const words = text.toLowerCase().split(/\s+/);

        words.forEach(word => {
            if (positiveWords.includes(word)) score++;
            if (negativeWords.includes(word)) score--;
        });

        return score;
    }

    document.getElementById('youtube-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const youtubeUrl = document.getElementById('youtube-url').value;
        const { id, type } = extractId(youtubeUrl);
        
        document.getElementById('loading').style.display = 'block';
        document.getElementById('error').style.display = 'none';
        document.getElementById('warning').style.display = 'none';
        document.getElementById('results').style.display = 'none';
        document.getElementById('channel-results').style.display = 'none';

        if (!id) {
            document.getElementById('error').textContent = 'URL YouTube invalide. Veuillez entrer une URL de vid√©o ou de cha√Æne YouTube valide.';
            document.getElementById('error').style.display = 'block';
            document.getElementById('loading').style.display = 'none';
            return;
        }

        try {
            const data = await fetchData(id, type);
            if (type === 'video') {
                displayVideoResults(data);
            } else if (type === 'channel') {
                displayChannelResults(data);
            }
        } catch (error) {
            let errorMessage = 'Une erreur s\'est produite lors de la r√©cup√©ration des donn√©es.';
            if (error.message === 'Aucune donn√©e trouv√©e') {
                errorMessage = 'Aucune donn√©e n\'a √©t√© trouv√©e pour cette URL. Veuillez v√©rifier que la vid√©o ou la cha√Æne existe et qu\'elle n\'est pas priv√©e.';
            }
            document.getElementById('error').textContent = errorMessage;
            document.getElementById('error').style.display = 'block';
        } finally {
            document.getElementById('loading').style.display = 'none';
        }
    });
    </script>
</body>
</html>